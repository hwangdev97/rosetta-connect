# Rosetta Connect 测试指南

## 🚀 构建完成

✅ 工具已成功构建！二进制文件位置：
```
target/release/rosetta-connect
文件大小: ~2.3MB
架构: ARM64 (Apple Silicon)
```

## 📋 完整测试流程

### 1. 基础功能测试

#### 1.1 查看帮助信息
```bash
# 查看主要帮助
./target/release/rosetta-connect --help

# 查看具体命令帮助
./target/release/rosetta-connect init --help
./target/release/rosetta-connect translate --help
```

#### 1.2 版本信息
```bash
./target/release/rosetta-connect --version
```

### 2. 项目初始化测试

#### 2.1 创建测试目录
```bash
# 创建一个干净的测试目录
mkdir ~/rosetta-test
cd ~/rosetta-test
```

#### 2.2 初始化项目
```bash
# 基本初始化
~/Develop/CLI/rosetta-connect/target/release/rosetta-connect init --bundle-id com.test.myapp

# 检查生成的文件
ls -la
cat rosetta.toml
cat .env
```

**期望结果:**
- ✅ 生成 `rosetta.toml` 配置文件
- ✅ 生成 `.env` 环境变量文件
- ✅ 创建 `screenshots/en/` 和 `screenshots/zh/` 目录
- ✅ 显示成功信息和配置摘要

### 3. 核心命令测试

#### 3.1 拉取命令测试
```bash
~/Develop/CLI/rosetta-connect/target/release/rosetta-connect pull
```

**期望结果:**
- ✅ 显示连接 App Store Connect 信息
- ✅ 显示 Node.js 运行时初始化
- ✅ 显示模拟的下载进度
- ✅ 显示下载的数据 JSON

#### 3.2 翻译命令测试
```bash
# 测试默认翻译
~/Develop/CLI/rosetta-connect/target/release/rosetta-connect translate

# 测试指定语言翻译
~/Develop/CLI/rosetta-connect/target/release/rosetta-connect translate --locales zh-Hans,fr-FR

# 测试指定模型
~/Develop/CLI/rosetta-connect/target/release/rosetta-connect translate --locales zh-Hans --model gpt-4
```

**期望结果:**
- ✅ 显示使用的 AI 模型
- ✅ 显示目标语言列表
- ✅ 显示每种语言的翻译进度
- ✅ 显示完成统计和成本估算

#### 3.3 差异对比测试
```bash
~/Develop/CLI/rosetta-connect/target/release/rosetta-connect diff
```

**期望结果:**
- ✅ 显示分析差异过程
- ✅ 显示具体的更改项目
- ✅ 显示变更统计摘要

#### 3.4 推送命令测试
```bash
# 测试交互式推送
~/Develop/CLI/rosetta-connect/target/release/rosetta-connect push 2.3.4

# 测试自动确认推送
~/Develop/CLI/rosetta-connect/target/release/rosetta-connect push 2.3.5 --yes
```

**期望结果:**
- ✅ 显示确认提示（非 --yes 模式）
- ✅ 显示进度条动画
- ✅ 显示上传统计信息

### 4. 实用命令测试

#### 4.1 内容验证
```bash
~/Develop/CLI/rosetta-connect/target/release/rosetta-connect validate
```

#### 4.2 内容预览
```bash
# 默认语言预览
~/Develop/CLI/rosetta-connect/target/release/rosetta-connect preview

# 指定语言预览
~/Develop/CLI/rosetta-connect/target/release/rosetta-connect preview --locale zh-Hans
```

#### 4.3 成本估算
```bash
# 基本成本估算
~/Develop/CLI/rosetta-connect/target/release/rosetta-connect cost

# 详细成本分解
~/Develop/CLI/rosetta-connect/target/release/rosetta-connect cost --detailed
```

#### 4.4 版本回滚
```bash
~/Develop/CLI/rosetta-connect/target/release/rosetta-connect rollback 2.3.3
```

#### 4.5 模板管理
```bash
# 列出模板
~/Develop/CLI/rosetta-connect/target/release/rosetta-connect template list

# 创建模板（需要先创建测试文件）
echo "请为这个应用生成简洁的描述：{app_name}" > test-prompt.txt
~/Develop/CLI/rosetta-connect/target/release/rosetta-connect template create test-template --file test-prompt.txt

# 删除模板
~/Develop/CLI/rosetta-connect/target/release/rosetta-connect template delete test-template
```

### 5. 错误处理测试

#### 5.1 无效配置测试
```bash
# 在没有 rosetta.toml 的目录中运行命令
cd /tmp
~/Develop/CLI/rosetta-connect/target/release/rosetta-connect pull
```

**期望结果:**
- ✅ 显示友好的错误信息
- ✅ 不会崩溃或产生不明确的错误

#### 5.2 无效参数测试
```bash
# 测试无效的命令参数
~/Develop/CLI/rosetta-connect/target/release/rosetta-connect invalid-command
~/Develop/CLI/rosetta-connect/target/release/rosetta-connect push  # 缺少版本号
```

### 6. 配置文件测试

#### 6.1 修改配置
回到测试目录并编辑配置：
```bash
cd ~/rosetta-test

# 修改 rosetta.toml
cat >> rosetta.toml << 'EOF'

[ai]
provider = "openai"
model = "gpt-4"
temperature = 0.8
max_tokens = 2048
EOF

# 再次运行翻译测试新配置
~/Develop/CLI/rosetta-connect/target/release/rosetta-connect translate
```

### 7. 调试模式测试

#### 7.1 启用调试输出
```bash
# 启用 JavaScript 调试模式
ROSETTA_DEBUG_JS=1 ~/Develop/CLI/rosetta-connect/target/release/rosetta-connect pull

# 启用详细输出
~/Develop/CLI/rosetta-connect/target/release/rosetta-connect --verbose pull
```

## 🧪 自动化测试脚本

创建一个简单的测试脚本：

```bash
#!/bin/bash
# 保存为 test-rosetta.sh

set -e

BINARY="$HOME/Develop/CLI/rosetta-connect/target/release/rosetta-connect"
TEST_DIR="$HOME/rosetta-test-$(date +%s)"

echo "🧪 开始 Rosetta Connect 功能测试"
echo "📁 测试目录: $TEST_DIR"

# 创建测试目录
mkdir -p "$TEST_DIR"
cd "$TEST_DIR"

# 测试 1: 初始化
echo "✅ 测试 1: 项目初始化"
"$BINARY" init --bundle-id com.test.automation

# 测试 2: 基本命令
echo "✅ 测试 2: 核心命令"
"$BINARY" pull
"$BINARY" translate --locales zh-Hans
"$BINARY" diff
"$BINARY" cost --detailed
"$BINARY" validate
"$BINARY" preview --locale zh-Hans

# 测试 3: 推送（自动确认）
echo "✅ 测试 3: 自动推送"
"$BINARY" push 1.0.0 --yes

# 测试 4: 模板管理
echo "✅ 测试 4: 模板管理"
echo "生成应用描述: {app_name}" > test.txt
"$BINARY" template create test-template --file test.txt
"$BINARY" template list
echo "y" | "$BINARY" template delete test-template

echo "🎉 所有测试完成！"
echo "📂 测试文件保存在: $TEST_DIR"
```

## 📊 测试检查清单

### ✅ 基础功能
- [ ] 帮助信息显示正确
- [ ] 版本信息显示正确  
- [ ] 项目初始化成功
- [ ] 配置文件生成正确

### ✅ 核心命令
- [ ] pull 命令执行成功
- [ ] translate 命令支持多种参数
- [ ] diff 命令显示差异
- [ ] push 命令显示进度条
- [ ] 进度条动画正常

### ✅ 实用功能
- [ ] validate 显示验证结果
- [ ] preview 显示内容预览
- [ ] cost 显示成本估算
- [ ] rollback 显示回滚信息
- [ ] template 管理功能正常

### ✅ 错误处理
- [ ] 无效命令显示帮助
- [ ] 缺少配置文件时友好提示
- [ ] 参数错误时显示正确帮助

### ✅ 输出质量
- [ ] 所有输出使用适当的图标和颜色
- [ ] 进度信息清晰易读
- [ ] 错误信息友好明确
- [ ] JSON 输出格式正确

## 🎯 性能测试

```bash
# 测试启动时间
time ~/Develop/CLI/rosetta-connect/target/release/rosetta-connect --help

# 测试内存使用
/usr/bin/time -l ~/Develop/CLI/rosetta-connect/target/release/rosetta-connect translate
```

## 📝 测试报告模板

测试完成后，记录结果：

```
测试日期: ___________
测试环境: macOS _____ / _____ 架构
二进制大小: _____ MB

基础功能: ✅/❌
核心命令: ✅/❌  
实用功能: ✅/❌
错误处理: ✅/❌
性能表现: ✅/❌

发现问题:
1. ___________
2. ___________

建议改进:
1. ___________
2. ___________
```

现在你可以开始测试了！建议按照上面的顺序逐步进行测试。