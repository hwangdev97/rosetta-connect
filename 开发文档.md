# Rosetta Connect å¼€å‘æ–‡æ¡£

## ğŸ“‹ ç›®å½•

- [é¡¹ç›®æ¦‚è¿°](#é¡¹ç›®æ¦‚è¿°)
- [æŠ€æœ¯æ¶æ„](#æŠ€æœ¯æ¶æ„)
- [å¼€å‘ç¯å¢ƒé…ç½®](#å¼€å‘ç¯å¢ƒé…ç½®)
- [é¡¹ç›®ç»“æ„](#é¡¹ç›®ç»“æ„)
- [æ ¸å¿ƒæ¨¡å—è¯¦è§£](#æ ¸å¿ƒæ¨¡å—è¯¦è§£)
- [å¼€å‘æŒ‡å—](#å¼€å‘æŒ‡å—)
- [ç¼–ç è§„èŒƒ](#ç¼–ç è§„èŒƒ)
- [æµ‹è¯•ç­–ç•¥](#æµ‹è¯•ç­–ç•¥)
- [éƒ¨ç½²å’Œå‘å¸ƒ](#éƒ¨ç½²å’Œå‘å¸ƒ)
- [è´¡çŒ®æŒ‡å—](#è´¡çŒ®æŒ‡å—)
- [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## ğŸ¯ é¡¹ç›®æ¦‚è¿°

**Rosetta Connect** æ˜¯ä¸€ä¸ªåŸºäº Rust æ„å»ºçš„ CLI å·¥å…·ï¼Œä¸“ä¸º iOS åº”ç”¨çš„ App Store Connect æœ¬åœ°åŒ–å·¥ä½œæµç¨‹è‡ªåŠ¨åŒ–è®¾è®¡ã€‚

### æ ¸å¿ƒä»·å€¼

- **ğŸš€ é«˜æ€§èƒ½**: åŸºäº Rustï¼Œé›¶è¿è¡Œæ—¶å¼€é”€
- **ğŸ¤– AI é©±åŠ¨**: é›†æˆ OpenAI GPT è¿›è¡Œæ™ºèƒ½ç¿»è¯‘
- **ğŸ“± å®Œæ•´å·¥ä½œæµ**: æ‹‰å–â†’ç¿»è¯‘â†’å®¡æŸ¥â†’æ¨é€çš„ä¸€ç«™å¼è§£å†³æ–¹æ¡ˆ
- **ğŸ”§ é›¶é…ç½®**: å¼€ç®±å³ç”¨ï¼Œå†…åµŒ Node.js è¿è¡Œæ—¶

### æŠ€æœ¯ç‰¹è‰²

- **æ··åˆæ¶æ„**: Rust æ ¸å¿ƒ + åµŒå…¥å¼ Node.js è¾¹è½¦
- **å¼‚æ­¥ä¼˜å…ˆ**: åŸºäº Tokio çš„å…¨å¼‚æ­¥å¤„ç†
- **ç±»å‹å®‰å…¨**: è·¨è¯­è¨€è¾¹ç•Œçš„å¼ºç±»å‹ä¿è¯
- **å•ä¸€äºŒè¿›åˆ¶**: æ— å¤–éƒ¨ä¾èµ–çš„ç‹¬ç«‹å¯æ‰§è¡Œæ–‡ä»¶

---

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### æ¶æ„æ¦‚è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Rosetta Connect                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   CLI å±‚        â”‚   æ ¸å¿ƒé€»è¾‘å±‚     â”‚      é›†æˆå±‚             â”‚
â”‚                 â”‚                 â”‚                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚    clap     â”‚ â”‚ â”‚   Config    â”‚ â”‚ â”‚    Node.js Bridge   â”‚ â”‚
â”‚ â”‚  Commands   â”‚ â”‚ â”‚  Manager    â”‚ â”‚ â”‚     (napi-rs)       â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                 â”‚                 â”‚                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Progress    â”‚ â”‚ â”‚ Translation â”‚ â”‚ â”‚ App Store Connect   â”‚ â”‚
â”‚ â”‚   UI        â”‚ â”‚ â”‚   Engine    â”‚ â”‚ â”‚       SDK           â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                 â”‚                 â”‚                         â”‚
â”‚                 â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚                 â”‚ â”‚  File I/O   â”‚ â”‚ â”‚    OpenAI API       â”‚ â”‚
â”‚                 â”‚ â”‚  Manager    â”‚ â”‚ â”‚     (HTTP)          â”‚ â”‚
â”‚                 â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æŠ€æœ¯æ ˆè¯¦è§£

| å±‚çº§ | æŠ€æœ¯ç»„ä»¶ | è¯´æ˜ |
|------|----------|------|
| **CLI æ¡†æ¶** | clap v4, color-eyre | å‘½ä»¤è¡Œå‚æ•°è§£æå’Œç¾è§‚çš„é”™è¯¯æŠ¥å‘Š |
| **å¼‚æ­¥è¿è¡Œæ—¶** | tokio v1, futures | é«˜æ€§èƒ½å¼‚æ­¥ I/O å’Œå¹¶å‘å¤„ç† |
| **Node.js é›†æˆ** | napi-rs, edon | åµŒå…¥å¼ Node.js è¿è¡Œæ—¶å’Œ FFI æ¡¥æ¥ |
| **é…ç½®ç®¡ç†** | serde, toml | ç±»å‹å®‰å…¨çš„é…ç½®åºåˆ—åŒ–å’Œååºåˆ—åŒ– |
| **HTTP å®¢æˆ·ç«¯** | reqwest, openai-rs | RESTful API äº¤äº’å’Œ AI æœåŠ¡é›†æˆ |
| **ç”¨æˆ·ç•Œé¢** | indicatif, console | è¿›åº¦æ¡ã€é¢œè‰²è¾“å‡ºå’Œäº¤äº’å¼ UI |

---

## âš™ï¸ å¼€å‘ç¯å¢ƒé…ç½®

### ç³»ç»Ÿè¦æ±‚

- **Rust**: 1.70+ (ä½¿ç”¨ `rustup` å®‰è£…)
- **Node.js**: 18+ (ä»…å¼€å‘æ—¶éœ€è¦)
- **Git**: æœ€æ–°ç‰ˆæœ¬
- **æ“ä½œç³»ç»Ÿ**: macOS, Linux, Windows

### å¿«é€Ÿå¼€å§‹

```bash
# 1. å…‹éš†é¡¹ç›®
git clone https://github.com/yourusername/rosetta-connect.git
cd rosetta-connect

# 2. å®‰è£… Rust å·¥å…·é“¾
rustup update stable
rustup default stable

# 3. å®‰è£…å¿…è¦çš„ Rust å·¥å…·
cargo install cargo-watch cargo-audit cargo-udeps

# 4. æ„å»ºé¡¹ç›®
cargo build

# 5. è¿è¡Œæµ‹è¯•
cargo test

# 6. æœ¬åœ°å¼€å‘æ„å»º
cargo build --release --features bundled-node
```

### å¼€å‘å·¥å…·é…ç½®

#### VSCode æ¨èæ‰©å±•

```json
{
  "recommendations": [
    "rust-lang.rust-analyzer",
    "vadimcn.vscode-lldb",
    "serayuzgur.crates",
    "tamasfe.even-better-toml"
  ]
}
```

#### Rust å·¥å…·é“¾è®¾ç½®

```bash
# å®‰è£…ç»„ä»¶
rustup component add clippy rustfmt rust-src

# è®¾ç½®å·¥å…·é…ç½®
echo 'edition = "2021"' >> Cargo.toml
```

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
rosetta-connect/
â”œâ”€â”€ ğŸ“ crates/                    # Rust å·¥ä½œç©ºé—´
â”‚   â”œâ”€â”€ ğŸ“ rc-cli/                # ä¸» CLI åº”ç”¨
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ Cargo.toml         # CLI ä¾èµ–é…ç½®
â”‚   â”‚   â””â”€â”€ ğŸ“ src/
â”‚   â”‚       â”œâ”€â”€ ğŸ“„ main.rs        # ç¨‹åºå…¥å£ç‚¹
â”‚   â”‚       â”œâ”€â”€ ğŸ“„ config.rs      # é…ç½®ç®¡ç†
â”‚   â”‚       â””â”€â”€ ğŸ“ commands/      # å‘½ä»¤å®ç°
â”‚   â”‚           â”œâ”€â”€ ğŸ“„ mod.rs     # å‘½ä»¤æ¨¡å—å£°æ˜
â”‚   â”‚           â”œâ”€â”€ ğŸ“„ init.rs    # åˆå§‹åŒ–å‘½ä»¤
â”‚   â”‚           â”œâ”€â”€ ğŸ“„ pull.rs    # æ‹‰å–å‘½ä»¤
â”‚   â”‚           â”œâ”€â”€ ğŸ“„ translate.rs # ç¿»è¯‘å‘½ä»¤
â”‚   â”‚           â”œâ”€â”€ ğŸ“„ push.rs    # æ¨é€å‘½ä»¤
â”‚   â”‚           â””â”€â”€ ğŸ“„ ...        # å…¶ä»–å‘½ä»¤
â”‚   â””â”€â”€ ğŸ“ rc-node/               # Node.js æ¡¥æ¥å±‚
â”‚       â”œâ”€â”€ ğŸ“„ Cargo.toml         # æ¡¥æ¥å±‚ä¾èµ–
â”‚       â””â”€â”€ ğŸ“ src/
â”‚           â””â”€â”€ ğŸ“„ lib.rs         # NAPI ç»‘å®š
â”œâ”€â”€ ğŸ“ js/                        # JavaScript/TypeScript æºç 
â”‚   â””â”€â”€ ğŸ“„ asc.ts                 # App Store Connect SDK å°è£…
â”œâ”€â”€ ğŸ“ help-center/               # ç”¨æˆ·æ–‡æ¡£
â”œâ”€â”€ ğŸ“ test-demo/                 # æµ‹è¯•å’Œæ¼”ç¤º
â”œâ”€â”€ ğŸ“„ Cargo.toml                 # å·¥ä½œç©ºé—´é…ç½®
â”œâ”€â”€ ğŸ“„ rosetta.toml               # é¡¹ç›®é…ç½®æ¨¡æ¿
â”œâ”€â”€ ğŸ“„ å¼€å‘æ–‡æ¡£.md                 # æœ¬æ–‡æ¡£
â””â”€â”€ ğŸ“„ README.md                  # é¡¹ç›®ä»‹ç»
```

### æ ¸å¿ƒæ–‡ä»¶è¯´æ˜

| æ–‡ä»¶ | ä½œç”¨ | é‡è¦æ€§ |
|------|------|--------|
| `crates/rc-cli/src/main.rs` | CLI ç¨‹åºå…¥å£ï¼Œå‘½ä»¤è·¯ç”± | â­â­â­â­â­ |
| `crates/rc-cli/src/config.rs` | é…ç½®ç»“æ„å®šä¹‰å’Œç®¡ç† | â­â­â­â­ |
| `crates/rc-node/src/lib.rs` | Rust-Node.js æ¡¥æ¥å±‚ | â­â­â­â­ |
| `js/asc.ts` | App Store Connect API å°è£… | â­â­â­â­ |
| `rosetta.toml` | ç”¨æˆ·é¡¹ç›®é…ç½®æ–‡ä»¶ | â­â­â­ |

---

## ğŸ”§ æ ¸å¿ƒæ¨¡å—è¯¦è§£

### 1. é…ç½®ç®¡ç†ç³»ç»Ÿ (`config.rs`)

```rust
#[derive(Debug, Serialize, Deserialize)]
pub struct Config {
    pub app: AppConfig,
    pub assets: Option<AssetsConfig>,
    pub ai: Option<AiConfig>,
}
```

**è®¾è®¡åŸåˆ™**:
- ä½¿ç”¨ `serde` ç¡®ä¿ç±»å‹å®‰å…¨çš„åºåˆ—åŒ–
- æ”¯æŒå¯é€‰é…ç½®é¡¹ï¼ˆ`Option<T>`ï¼‰
- æä¾›åˆç†çš„é»˜è®¤å€¼
- æ”¯æŒç¯å¢ƒå˜é‡è¦†ç›–

**é…ç½®åŠ è½½ä¼˜å…ˆçº§**:
1. å‘½ä»¤è¡Œå‚æ•°
2. ç¯å¢ƒå˜é‡
3. `rosetta.toml` æ–‡ä»¶
4. å†…ç½®é»˜è®¤å€¼

### 2. å‘½ä»¤ç³»ç»Ÿ (`commands/`)

æ¯ä¸ªå‘½ä»¤æ¨¡å—éµå¾ªç»Ÿä¸€æ¥å£ï¼š

```rust
pub async fn run(/* å‚æ•° */, config_path: &Path) -> anyhow::Result<()> {
    // 1. åŠ è½½é…ç½®
    let config = Config::load(config_path)?;
    
    // 2. éªŒè¯å‚æ•°
    validate_params()?;
    
    // 3. æ‰§è¡Œæ ¸å¿ƒé€»è¾‘
    execute_core_logic().await?;
    
    // 4. è¾“å‡ºç»“æœ
    display_results()?;
    
    Ok(())
}
```

### 3. Node.js æ¡¥æ¥å±‚ (`rc-node`)

```rust
#[napi]
pub async fn asc_upload(metadata: JsObject) -> napi::Result<JsObject> {
    // è°ƒç”¨åµŒå…¥çš„ Node.js å‡½æ•°
}
```

**æ¡¥æ¥ç­–ç•¥**:
- ä½¿ç”¨ `napi-rs` è¿›è¡Œç±»å‹å®‰å…¨çš„æ•°æ®ä¼ é€’
- æ‰€æœ‰å¼‚æ­¥æ“ä½œè¿”å› `Promise`
- é”™è¯¯å¤„ç†ç»Ÿä¸€æ˜ å°„åˆ° Rust ç±»å‹

---

## ğŸ’» å¼€å‘æŒ‡å—

### å¼€å‘å·¥ä½œæµ

1. **åŠŸèƒ½åˆ†æ”¯**: ä» `main` åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
2. **æœ¬åœ°å¼€å‘**: ä½¿ç”¨ `cargo watch` è¿›è¡Œçƒ­é‡è½½
3. **ä»£ç æ£€æŸ¥**: è¿è¡Œ `cargo clippy` å’Œ `cargo fmt`
4. **æµ‹è¯•éªŒè¯**: æ‰§è¡Œ `cargo test` ç¡®ä¿æµ‹è¯•é€šè¿‡
5. **æäº¤ä»£ç **: éµå¾ª Conventional Commits è§„èŒƒ
6. **åˆ›å»º PR**: æäº¤ Pull Request è¿›è¡Œä»£ç å®¡æŸ¥

### æ·»åŠ æ–°å‘½ä»¤

1. **åˆ›å»ºå‘½ä»¤æ–‡ä»¶**:
```bash
touch crates/rc-cli/src/commands/æ–°å‘½ä»¤.rs
```

2. **å®ç°å‘½ä»¤é€»è¾‘**:
```rust
// crates/rc-cli/src/commands/æ–°å‘½ä»¤.rs
use anyhow::Result;
use std::path::Path;

pub async fn run(/* å‚æ•° */, config_path: &Path) -> Result<()> {
    // å®ç°å‘½ä»¤é€»è¾‘
    Ok(())
}
```

3. **æ³¨å†Œå‘½ä»¤**:
```rust
// crates/rc-cli/src/commands/mod.rs
pub mod æ–°å‘½ä»¤;

// crates/rc-cli/src/main.rs
enum Commands {
    æ–°å‘½ä»¤ {
        // å‘½ä»¤å‚æ•°
    },
}
```

### è°ƒè¯•æŠ€å·§

#### å¯ç”¨è¯¦ç»†æ—¥å¿—
```bash
export ROSETTA_DEBUG_JS=1
export RUST_LOG=debug
cargo run -- your-command --verbose
```

#### ä½¿ç”¨ LLDB è°ƒè¯•
```bash
# æ„å»ºè°ƒè¯•ç‰ˆæœ¬
cargo build

# å¯åŠ¨ LLDB
lldb target/debug/rosetta-connect
(lldb) run init --bundle-id com.example.test
```

#### æ€§èƒ½åˆ†æ
```bash
# å®‰è£…æ€§èƒ½åˆ†æå·¥å…·
cargo install cargo-profiling

# è¿è¡Œæ€§èƒ½åˆ†æ
cargo profiling run --bin rosetta-connect
```

---

## ğŸ“ ç¼–ç è§„èŒƒ

### Rust ä»£ç é£æ ¼

#### 1. å‘½åçº¦å®š
```rust
// âœ… æ­£ç¡®
struct AppConfig { ... }
fn load_configuration() -> Result<Config> { ... }
const DEFAULT_TIMEOUT: Duration = Duration::from_secs(30);

// âŒ é”™è¯¯
struct appconfig { ... }
fn loadConfiguration() -> Result<Config> { ... }
const default_timeout: Duration = Duration::from_secs(30);
```

#### 2. é”™è¯¯å¤„ç†
```rust
// âœ… æ¨èï¼šä½¿ç”¨ anyhow è¿›è¡Œé”™è¯¯ä¼ æ’­
fn parse_config(path: &Path) -> anyhow::Result<Config> {
    let content = std::fs::read_to_string(path)
        .with_context(|| format!("æ— æ³•è¯»å–é…ç½®æ–‡ä»¶: {}", path.display()))?;
    
    Ok(toml::from_str(&content)?)
}

// âŒ é¿å…ï¼šä¸æä¾›ä¸Šä¸‹æ–‡çš„é”™è¯¯å¤„ç†
fn parse_config(path: &Path) -> Result<Config, Box<dyn std::error::Error>> {
    let content = std::fs::read_to_string(path)?;
    Ok(toml::from_str(&content)?)
}
```

#### 3. å¼‚æ­¥ä»£ç 
```rust
// âœ… æ¨èï¼šä½¿ç”¨ async/await
async fn fetch_app_info(bundle_id: &str) -> Result<AppInfo> {
    let client = reqwest::Client::new();
    let response = client
        .get(&format!("https://api.appstore.com/apps/{}", bundle_id))
        .send()
        .await?;
    
    response.json().await
}

// âœ… æ¨èï¼šå¹¶å‘å¤„ç†å¤šä¸ªä»»åŠ¡
async fn process_multiple_locales(locales: Vec<String>) -> Result<()> {
    let tasks: Vec<_> = locales.into_iter()
        .map(|locale| tokio::spawn(process_locale(locale)))
        .collect();
    
    // ç­‰å¾…æ‰€æœ‰ä»»åŠ¡å®Œæˆ
    for task in tasks {
        task.await??;
    }
    
    Ok(())
}
```

### æ–‡æ¡£æ ‡å‡†

#### 1. æ¨¡å—æ–‡æ¡£
```rust
//! # é…ç½®ç®¡ç†æ¨¡å—
//! 
//! æœ¬æ¨¡å—è´Ÿè´£ï¼š
//! - è§£æ `rosetta.toml` é…ç½®æ–‡ä»¶
//! - æä¾›é»˜è®¤é…ç½®å€¼
//! - æ”¯æŒç¯å¢ƒå˜é‡è¦†ç›–

use serde::{Deserialize, Serialize};
```

#### 2. å‡½æ•°æ–‡æ¡£
```rust
/// ä»æŒ‡å®šè·¯å¾„åŠ è½½é…ç½®æ–‡ä»¶
/// 
/// # å‚æ•°
/// 
/// * `path` - é…ç½®æ–‡ä»¶è·¯å¾„
/// 
/// # è¿”å›å€¼
/// 
/// è¿”å›è§£æåçš„ `Config` ç»“æ„ä½“
/// 
/// # é”™è¯¯
/// 
/// å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨æˆ–æ ¼å¼é”™è¯¯ï¼Œè¿”å›ç›¸åº”é”™è¯¯
/// 
/// # ç¤ºä¾‹
/// 
/// ```rust
/// let config = Config::load(Path::new("rosetta.toml"))?;
/// ```
pub fn load(path: &Path) -> anyhow::Result<Config> {
    // å®ç°
}
```

---

## ğŸ§ª æµ‹è¯•ç­–ç•¥

### æµ‹è¯•å±‚çº§

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              E2E æµ‹è¯•               â”‚  â† å®Œæ•´å·¥ä½œæµæµ‹è¯•
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚             é›†æˆæµ‹è¯•                â”‚  â† æ¨¡å—é—´äº¤äº’æµ‹è¯•
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚             å•å…ƒæµ‹è¯•                â”‚  â† å‡½æ•°çº§åˆ«æµ‹è¯•
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å•å…ƒæµ‹è¯•

```rust
#[cfg(test)]
mod tests {
    use super::*;
    use tempfile::TempDir;

    #[test]
    fn test_config_load_success() {
        let temp_dir = TempDir::new().unwrap();
        let config_path = temp_dir.path().join("test.toml");
        
        let config_content = r#"
            [app]
            bundle_id = "com.test.app"
            default_locale = "en-US"
            target_locales = ["zh-Hans"]
        "#;
        
        std::fs::write(&config_path, config_content).unwrap();
        
        let config = Config::load(&config_path).unwrap();
        assert_eq!(config.app.bundle_id, "com.test.app");
    }
    
    #[tokio::test]
    async fn test_async_function() {
        let result = async_function().await;
        assert!(result.is_ok());
    }
}
```

### é›†æˆæµ‹è¯•

```rust
// tests/integration_tests.rs
use rosetta_connect::config::Config;
use std::process::Command;

#[test]
fn test_cli_init_command() {
    let output = Command::new("target/debug/rosetta-connect")
        .args(&["init", "--bundle-id", "com.test.app"])
        .output()
        .expect("Failed to execute command");
    
    assert!(output.status.success());
}
```

### æµ‹è¯•è¿è¡Œ

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
cargo test

# è¿è¡Œç‰¹å®šæ¨¡å—æµ‹è¯•
cargo test config

# è¿è¡Œé›†æˆæµ‹è¯•
cargo test --test integration_tests

# ç”Ÿæˆæµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š
cargo install cargo-tarpaulin
cargo tarpaulin --out Html
```

---

## ğŸš€ éƒ¨ç½²å’Œå‘å¸ƒ

### æ„å»ºé…ç½®

#### å¼€å‘æ„å»º
```bash
cargo build --features dev-tools
```

#### å‘å¸ƒæ„å»º
```bash
cargo build --release --features bundled-node
```

#### äº¤å‰ç¼–è¯‘
```bash
# macOS
cargo build --release --target x86_64-apple-darwin
cargo build --release --target aarch64-apple-darwin

# Linux
cargo build --release --target x86_64-unknown-linux-gnu

# Windows
cargo build --release --target x86_64-pc-windows-msvc
```

### CI/CD é…ç½®

#### GitHub Actions å·¥ä½œæµ

```yaml
name: CI/CD Pipeline

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main ]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Install Rust
        uses: actions-rs/toolchain@v1
        with:
          toolchain: stable
      - name: Run tests
        run: cargo test --all-features

  build:
    needs: test
    strategy:
      matrix:
        os: [ubuntu-latest, macos-latest, windows-latest]
    runs-on: ${{ matrix.os }}
    steps:
      - uses: actions/checkout@v3
      - name: Build release
        run: cargo build --release --features bundled-node
      - name: Upload artifacts
        uses: actions/upload-artifact@v3
        with:
          name: rosetta-connect-${{ matrix.os }}
          path: target/release/rosetta-connect*
```

### å‘å¸ƒæµç¨‹

1. **ç‰ˆæœ¬å‡†å¤‡**
```bash
# æ›´æ–°ç‰ˆæœ¬å·
vim Cargo.toml
vim crates/rc-cli/Cargo.toml

# æ›´æ–° CHANGELOG
vim CHANGELOG.md

# æäº¤ç‰ˆæœ¬å˜æ›´
git add .
git commit -m "chore: bump version to v1.2.0"
```

2. **åˆ›å»ºå‘å¸ƒæ ‡ç­¾**
```bash
git tag v1.2.0
git push origin v1.2.0
```

3. **æ„å»ºå’Œä¸Šä¼ **
```bash
# æ„å»ºæ‰€æœ‰å¹³å°
./scripts/build-all-platforms.sh

# åˆ›å»º GitHub Release
gh release create v1.2.0 \
  --title "Release v1.2.0" \
  --notes-file CHANGELOG.md \
  dist/*
```

---

## ğŸ¤ è´¡çŒ®æŒ‡å—

### è´¡çŒ®æµç¨‹

1. **Fork é¡¹ç›®** åˆ°ä½ çš„ GitHub è´¦æˆ·
2. **åˆ›å»ºåŠŸèƒ½åˆ†æ”¯** `git checkout -b feature/awesome-feature`
3. **æäº¤å˜æ›´** `git commit -m 'feat: add awesome feature'`
4. **æ¨é€åˆ†æ”¯** `git push origin feature/awesome-feature`
5. **åˆ›å»º Pull Request**

### æäº¤ä¿¡æ¯è§„èŒƒ

æˆ‘ä»¬ä½¿ç”¨ [Conventional Commits](https://www.conventionalcommits.org/) è§„èŒƒï¼š

```
<type>[optional scope]: <description>

[optional body]

[optional footer(s)]
```

#### ç±»å‹è¯´æ˜

| ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `feat` | æ–°åŠŸèƒ½ | `feat: add rollback command` |
| `fix` | é”™è¯¯ä¿®å¤ | `fix: handle timeout in API calls` |
| `docs` | æ–‡æ¡£æ›´æ–° | `docs: update installation guide` |
| `style` | ä»£ç æ ¼å¼ | `style: fix rustfmt warnings` |
| `refactor` | ä»£ç é‡æ„ | `refactor: simplify config loading` |
| `test` | æµ‹è¯•ç›¸å…³ | `test: add unit tests for config` |
| `chore` | æ„å»º/å·¥å…· | `chore: update dependencies` |

### ä»£ç å®¡æŸ¥æ¸…å•

#### Pull Request æ£€æŸ¥é¡¹

- [ ] ä»£ç éµå¾ªé¡¹ç›®ç¼–ç è§„èŒƒ
- [ ] æ·»åŠ äº†å¿…è¦çš„æµ‹è¯•ç”¨ä¾‹
- [ ] æµ‹è¯•é€šè¿‡ (`cargo test`)
- [ ] æ–‡æ¡£å·²æ›´æ–°ï¼ˆå¦‚é€‚ç”¨ï¼‰
- [ ] æäº¤ä¿¡æ¯ç¬¦åˆè§„èŒƒ
- [ ] æ²¡æœ‰å¼•å…¥æ–°çš„ Clippy è­¦å‘Š
- [ ] æ€§èƒ½æ²¡æœ‰æ˜¾è‘—é€€åŒ–

#### å®¡æŸ¥è€…æ£€æŸ¥é¡¹

- [ ] åŠŸèƒ½éœ€æ±‚æ˜¯å¦æ­£ç¡®å®ç°
- [ ] ä»£ç è®¾è®¡æ˜¯å¦åˆç†
- [ ] é”™è¯¯å¤„ç†æ˜¯å¦å®Œå–„
- [ ] æ˜¯å¦éµå¾ªæœ€ä½³å®è·µ
- [ ] æ˜¯å¦è€ƒè™‘äº†è¾¹ç•Œæƒ…å†µ

---

## â“ å¸¸è§é—®é¢˜

### å¼€å‘ç¯å¢ƒé—®é¢˜

#### Q: ç¼–è¯‘æ—¶å‡ºç° "could not find libnode" é”™è¯¯

**A**: è¿™é€šå¸¸æ˜¯å› ä¸ºæ²¡æœ‰æ­£ç¡®é…ç½® Node.js å¼€å‘ç¯å¢ƒã€‚

```bash
# macOS
brew install node

# Ubuntu/Debian
sudo apt-get install nodejs-dev

# ç¡®ä¿ç¯å¢ƒå˜é‡æ­£ç¡®è®¾ç½®
export NODE_PATH=$(which node)
export LIBNODE_PATH=/usr/lib/node_modules
```

#### Q: `cargo build` å¾ˆæ…¢æ€ä¹ˆåŠï¼Ÿ

**A**: å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼ä¼˜åŒ–ï¼š

```bash
# ä½¿ç”¨ Rust å›½å†…é•œåƒ
echo '[source.crates-io]
replace-with = "ustc"

[source.ustc]
registry = "git://mirrors.ustc.edu.cn/crates.io-index"' > ~/.cargo/config

# å¹¶è¡Œç¼–è¯‘
export CARGO_BUILD_JOBS=4

# ä½¿ç”¨ sccache ç¼“å­˜
cargo install sccache
export RUSTC_WRAPPER=sccache
```

### è¿è¡Œæ—¶é—®é¢˜

#### Q: "Permission denied" é”™è¯¯

**A**: ç¡®ä¿äºŒè¿›åˆ¶æ–‡ä»¶æœ‰æ‰§è¡Œæƒé™ï¼š

```bash
chmod +x target/release/rosetta-connect
```

#### Q: API è°ƒç”¨è¶…æ—¶

**A**: æ£€æŸ¥ç½‘ç»œè¿æ¥å’Œ API é…ç½®ï¼š

```bash
# æµ‹è¯•ç½‘ç»œè¿æ¥
curl -I https://api.appstoreconnect.apple.com/

# å¢åŠ è¶…æ—¶æ—¶é—´
export ROSETTA_API_TIMEOUT=60

# å¯ç”¨è°ƒè¯•æ¨¡å¼
export ROSETTA_DEBUG=1
```

### é…ç½®é—®é¢˜

#### Q: `rosetta.toml` æ ¼å¼é”™è¯¯

**A**: éªŒè¯ TOML æ ¼å¼ï¼š

```bash
# å®‰è£… TOML éªŒè¯å·¥å…·
cargo install toml-cli

# éªŒè¯é…ç½®æ–‡ä»¶
toml-cli verify rosetta.toml
```

#### Q: AI ç¿»è¯‘è´¨é‡ä¸å¥½

**A**: è°ƒæ•´ AI é…ç½®å‚æ•°ï¼š

```toml
[ai]
provider = "openai"
model = "gpt-4"  # ä½¿ç”¨æ›´å¼ºçš„æ¨¡å‹
temperature = 0.3  # é™ä½éšæœºæ€§
max_tokens = 2048  # å¢åŠ è¾“å‡ºé•¿åº¦
```

### æ€§èƒ½ä¼˜åŒ–

#### Q: å¦‚ä½•æé«˜ç¿»è¯‘é€Ÿåº¦ï¼Ÿ

**A**: ä½¿ç”¨å¹¶å‘å¤„ç†ï¼š

```rust
// é…ç½®å¹¶å‘æ•°é‡
const MAX_CONCURRENT_REQUESTS: usize = 10;

// ä½¿ç”¨ semaphore æ§åˆ¶å¹¶å‘
let semaphore = Arc::new(Semaphore::new(MAX_CONCURRENT_REQUESTS));
```

#### Q: å†…å­˜å ç”¨è¿‡é«˜

**A**: åˆ†æ‰¹å¤„ç†å¤§é‡æ•°æ®ï¼š

```rust
// åˆ†æ‰¹å¤„ç†
const BATCH_SIZE: usize = 100;
for chunk in data.chunks(BATCH_SIZE) {
    process_batch(chunk).await?;
}
```

---

## ğŸ“š æ‰©å±•é˜…è¯»

### ç›¸å…³æ–‡æ¡£

- [Rust å®˜æ–¹æ–‡æ¡£](https://doc.rust-lang.org/)
- [Tokio å¼‚æ­¥ç¼–ç¨‹æŒ‡å—](https://tokio.rs/tokio/tutorial)
- [App Store Connect API æ–‡æ¡£](https://developer.apple.com/documentation/appstoreconnectapi)
- [OpenAI API æ–‡æ¡£](https://platform.openai.com/docs)

### æ¨èå·¥å…·

- **å¼€å‘å·¥å…·**: [Rust Analyzer](https://rust-analyzer.github.io/), [Cargo Watch](https://github.com/watchexec/cargo-watch)
- **è°ƒè¯•å·¥å…·**: [LLDB](https://lldb.llvm.org/), [GDB](https://www.gnu.org/software/gdb/)
- **æ€§èƒ½åˆ†æ**: [cargo-profiling](https://github.com/svenstaro/cargo-profiling), [Flamegraph](https://github.com/flamegraph-rs/flamegraph)
- **ä»£ç è´¨é‡**: [Clippy](https://github.com/rust-lang/rust-clippy), [Rustfmt](https://github.com/rust-lang/rustfmt)

---

*æœ€åæ›´æ–°: 2024å¹´12æœˆ*

*ç»´æŠ¤è€…: Rosetta Connect å¼€å‘å›¢é˜Ÿ*

å¦‚æœ‰ç–‘é—®ï¼Œè¯·åœ¨ [GitHub Issues](https://github.com/yourusername/rosetta-connect/issues) ä¸­æå‡ºã€‚